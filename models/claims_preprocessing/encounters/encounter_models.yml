version: 2

models:
#### Encounters

## Final
  - name: acute_inpatient__encounter_grain
    description: This table pulls together all the data needed to perform acute inpatient analytics into a single table.
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_acute_inpatient__encounter_grain{% else %}acute_inpatient__encounter_grain{%- endif -%}
      tags: 
        - acute_inpatient
        - claims_preprocessing
        - encounters
      materialized: table
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'


  - name: emergency_department__encounter_grain
    description: This table pulls together all the data needed to perform acute inpatient analytics into a single table.
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_emergency_department__encounter_grain{% else %}emergency_department__encounter_grain{%- endif -%}
      tags: 
        - emergency_department
        - claims_preprocessing
        - encounters
      materialized: table
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'


  - name: inpatient_psych__encounter_grain
    description: "Encounters for inpatient psych. One row per encounter."
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_psych__encounter_grain{% else %}inpatient_psych__encounter_grain{%- endif -%}
      materialized: table
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: inpatient_rehab__encounter_grain
    description: "Encounters for inpatient rehab. One row per encounter."
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}
          {{ var('tuva_schema_prefix') }}_claims_preprocessing
        {%- else -%}
          claims_preprocessing
        {%- endif -%}
      materialized: table
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_rehab__encounter_grain{% else %}inpatient_rehab__encounter_grain{%- endif -%}
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: inpatient_snf__encounter_grain
    description: "Encounters for inpatient rehab. One row per encounter."
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_snf__encounter_grain{% else %}inpatient_snf__encounter_grain{%- endif -%}
      materialized: table
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: inpatient_substance_use__encounter_grain
    description: "Encounters for inpatient rehab. One row per encounter."
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_substance_use__encounter_grain{% else %}inpatient_substance_use__encounter_grain{%- endif -%}
      materialized: table
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: inpatient_hospice__encounter_grain
    description: "Encounters for inpatient rehab. One row per encounter."
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_hospice__encounter_grain{% else %}inpatient_hospice__encounter_grain{%- endif -%}
      materialized: table
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: encounters__combined_claim_line_crosswalk
    description: all claim lines that belong to an encounter
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_encounters__combined_claim_line_crosswalk{% else %}encounters__combined_claim_line_crosswalk{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'    

  - name: urgent_care__encounter_grain
    description: one row per urgent care encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_urgent_care__encounter_grain{% else %}urgent_care__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: outpatient_psych__encounter_grain
    description: one row per outpatient psych encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_psych__encounter_grain{% else %}outpatient_psych__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: outpatient_rehab__encounter_grain
    description: one row per outpatient rehab encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_rehab__encounter_grain{% else %}outpatient_rehab__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'
  
  - name: outpatient_hospital_or_clinic__encounter_grain
    description: one row per outpatient rehab encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_hospital_or_clinic__encounter_grain{% else %}outpatient_hospital_or_clinic__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: outpatient_surgery__encounter_grain
    description: one row per outpatient rehab encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_surgery__encounter_grain{% else %}outpatient_surgery__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: asc__encounter_grain
    description: one row per asc encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_asc__encounter_grain{% else %}asc__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: dialysis__encounter_grain
    description: one row per dialysis encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_dialysis__encounter_grain{% else %}dialysis__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: outpatient_hospice__encounter_grain
    description: one row per outpatient hospice encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_hospice__encounter_grain{% else %}outpatient_hospice__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: home_health__encounter_grain
    description: one row per outpatient hospice encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_home_health__encounter_grain{% else %}home_health__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: outpatient_injections__encounter_grain
    description: one row per outpatient hospice encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_injections__encounter_grain{% else %}outpatient_injections__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: outpatient_substance_use__encounter_grain
    description: one row per outpatient hospice encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_substance_use__encounter_grain{% else %}outpatient_substance_use__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: outpatient_ptotst__encounter_grain
    description: one row per outpatient hospice encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_ptotst__encounter_grain{% else %}outpatient_ptotst__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: outpatient_radiology__encounter_grain
    description: one row per outpatient radiology encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_radiology__encounter_grain{% else %}outpatient_radiology__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: office_visit__encounter_grain
    description: one row per outpatient office visit surgery encounter id summarizing encounter level metrics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visit__encounter_grain{% else %}office_visit__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: lab__encounter_grain
    description: one row per lab encounter id summarizing encounter level metrics. labs will roll up to other encounters unless they appear on their own day with no other claims.
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_lab__encounter_grain{% else %}lab__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: dme__encounter_grain
    description: one row per dme encounter id summarizing encounter level metrics. dmes will roll up to other encounters unless they appear on their own day with no other claims.
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_dme__encounter_grain{% else %}dme__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: ambulance__encounter_grain
    description: one row per ambulance encounter id summarizing encounter level metrics. ambulances will roll up to other encounters unless they appear on their own day with no other claims.
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_ambulance__encounter_grain{% else %}ambulance__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'


  - name: orphaned_claim__encounter_grain
    description: orphaned claims (usually professional claims) that don't roll up to an anchor event, get assigned their own encounter id for completeness. 
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_orphaned_claim__encounter_grain{% else %}orphaned_claim__encounter_grain{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters
    columns:
      - name: encounter_id
        description: '{{ doc("encounter_id") }}'
      - name: encounter_start_date
        description: '{{ doc("encounter_start_date") }}'
      - name: encounter_end_date
        description: '{{ doc("encounter_end_date") }}'
      - name: patient_data_source_id
        description: '{{ doc("patient_data_source_id") }}'
      - name: encounter_type
        description: '{{ doc("encounter_type") }}'
      - name: encounter_group
        description: '{{ doc("encounter_group") }}'
      - name: person_id
        description: '{{ doc("person_id") }}'
      - name: admit_age
        description: '{{ doc("admit_age") }}'
      - name: gender
        description: '{{ doc("gender") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__gender.csv
      - name: race
        description: '{{ doc("race") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__race.csv
      - name: primary_diagnosis_code_type
        description: '{{ doc("primary_diagnosis_code_type") }}'
      - name: primary_diagnosis_code
        description: '{{ doc("primary_diagnosis_code") }}'
      - name: primary_diagnosis_description
        description: '{{ doc("primary_diagnosis_description") }}'
      - name: facility_id
        description: '{{ doc("facility_id") }}'
      - name: observation_flag
        description: '{{ doc("observation_flag") }}'
      - name: ed_flag
        description: '{{ doc("ed_flag") }}'
      - name: lab_flag
        description: '{{ doc("lab_flag") }}'
      - name: dme_flag
        description: '{{ doc("dme_flag") }}'
      - name: ambulance_flag
        description: '{{ doc("ambulance_flag") }}'
      - name: pharmacy_flag
        description: '{{ doc("pharmacy_flag") }}'
      - name: facility_name
        description: '{{ doc("facility_name") }}'
      - name: facility_type
        description: '{{ doc("facility_type") }}'
      - name: delivery_flag
        description: '{{ doc("delivery_flag") }}'
      - name: delivery_type
        description: '{{ doc("delivery_type") }}'
      - name: newborn_flag
        description: '{{ doc("newborn_flag") }}'
      - name: nicu_flag
        description: '{{ doc("nicu_flag") }}'
      - name: facility_npi
        description: '{{ doc("facility_npi") }}'
      - name: provider_first_name
        description: '{{ doc("provider_first_name") }}'
      - name: provider_last_name
        description: '{{ doc("provider_last_name") }}'
      - name: drg_code_type
        description: '{{ doc("drg_code_type") }}'
      - name: drg_code
        description: '{{ doc("drg_code") }}'
      - name: drg_description
        description: '{{ doc("drg_description") }}'
      - name: medical_surgical
        description: '{{ doc("medical_surgical") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__ms_drg.csv
      - name: admit_source_code
        description: '{{ doc("admit_source_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_source.csv
      - name: admit_source_description
        description: '{{ doc("admit_source_description") }}'
      - name: admit_type_code
        description: '{{ doc("admit_type_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__admit_type.csv
      - name: admit_type_description
        description: '{{ doc("admit_type_description") }}'
      - name: discharge_disposition_code
        description: '{{ doc("discharge_disposition_code") }}'
        meta:
          terminology: https://github.com/tuva-health/the_tuva_project/blob/main/seeds/terminology/terminology__discharge_disposition.csv
      - name: discharge_disposition_description
        description: '{{ doc("discharge_disposition_description") }}'
      - name: total_paid_amount
        description: '{{ doc("total_paid_amount") }}'
      - name: total_allowed_amount
        description: '{{ doc("total_allowed_amount") }}'
      - name: total_charge_amount
        description: '{{ doc("total_charge_amount") }}'
      - name: claim_count
        description: '{{ doc("claim_count") }}'
      - name: inst_claim_count
        description: '{{ doc("inst_claim_count") }}'
      - name: prof_claim_count
        description: '{{ doc("prof_claim_count") }}'
      - name: length_of_stay
        description: '{{ doc("length_of_stay") }}'
      - name: mortality_flag
        description: '{{ doc("mortality_flag") }}'
      - name: data_source
        description: '{{ doc("data_source") }}'
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'




## Intermediate
## acute inpatient
  - name: acute_inpatient__generate_encounter_id
    description: generate encounter id and stitch inpatient psych claims together
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_acute_inpatient__generate_encounter_id{% else %}acute_inpatient__generate_encounter_id{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: acute_inpatient__start_end_dates
    description: calculate start and end date of encounter 
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_acute_inpatient__start_end_dates{% else %}acute_inpatient__start_end_dates{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: acute_inpatient__prof_claims
    description: match corresponding prof claims to institutional claims
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_acute_inpatient__prof_claims{% else %}acute_inpatient__prof_claims{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

## ed
  - name: emergency_department__generate_encounter_id
    description: generate encounter id and stitch inpatient psych claims together
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_emergency_department__generate_encounter_id{% else %}emergency_department__generate_encounter_id{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: emergency_department__generate_encounter_id_pre_sort
    description: generate encounter id and stitch inpatient psych claims together
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_emergency_department__generate_encounter_id_pre_sort{% else %}emergency_department__generate_encounter_id_pre_sort{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: emergency_department__start_end_dates
    description: calculate start and end date of encounter 
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_emergency_department__start_end_dates{% else %}emergency_department__start_end_dates{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: emergency_department__prof_claims
    description: match corresponding prof claims to institutional claims
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_emergency_department__prof_claims{% else %}emergency_department__prof_claims{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters


  - name: inpatient_psych__generate_encounter_id
    description: generate encounter id and stitch inpatient psych claims together
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_psych__generate_encounter_id{% else %}inpatient_psych__generate_encounter_id{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_psych__start_end_dates
    description: calculate start and end date of encounter 
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_psych__start_end_dates{% else %}inpatient_psych__start_end_dates{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_psych__prof_claims
    description: match corresponding prof claims to institutional claims
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_psych__prof_claims{% else %}inpatient_psych__prof_claims{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters


##inpatient rehab
  - name: inpatient_rehab__generate_encounter_id
    description: generate encounter id and stitch inpatient rehab claims together
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_rehab__generate_encounter_id{% else %}inpatient_rehab__generate_encounter_id{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_rehab__start_end_dates
    description: calculate start and end date of encounter 
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_rehab__start_end_dates{% else %}inpatient_rehab__start_end_dates{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_rehab__prof_claims
    description: match corresponding prof claims to institutional claims
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_rehab__prof_claims{% else %}inpatient_rehab__prof_claims{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

##inpatient long term actue care
  - name: inpatient_long_term__generate_encounter_id
    description: generate encounter id and stitch inpatient ltac claims together
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {%- else -%}claims_preprocessing{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_long_term__start_end_dates
    description: calculate start and end date of encounter 
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {%- else -%}claims_preprocessing{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_long_term__prof_claims
    description: match corresponding prof claims to institutional claims
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {%- else -%}claims_preprocessing{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters



##inpatient snf
  - name: inpatient_snf__generate_encounter_id
    description: generate encounter id and stitch inpatient snf claims together
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_snf__generate_encounter_id{% else %}inpatient_snf__generate_encounter_id{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_snf__start_end_dates
    description: calculate start and end date of encounter 
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_snf__start_end_dates{% else %}inpatient_snf__start_end_dates{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_snf__prof_claims
    description: match corresponding prof claims to institutional claims
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_snf__prof_claims{% else %}inpatient_snf__prof_claims{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

##inpatient substance use
  - name: inpatient_substance_use__generate_encounter_id
    description: generate encounter id and stitch inpatient substance_use claims together
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_substance_use__generate_encounter_id{% else %}inpatient_substance_use__generate_encounter_id{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_substance_use__start_end_dates
    description: calculate start and end date of encounter 
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_substance_use__start_end_dates{% else %}inpatient_substance_use__start_end_dates{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_substance_use__prof_claims
    description: match corresponding prof claims to institutional claims
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_substance_use__prof_claims{% else %}inpatient_substance_use__prof_claims{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

##inpatient hospice
  - name: inpatient_hospice__generate_encounter_id
    description: generate encounter id and stitch inpatient hospice claims together
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_hospice__generate_encounter_id{% else %}inpatient_hospice__generate_encounter_id{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_hospice__start_end_dates
    description: calculate start and end date of encounter 
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_hospice__start_end_dates{% else %}inpatient_hospice__start_end_dates{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: inpatient_hospice__prof_claims
    description: match corresponding prof claims to institutional claims
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_inpatient_hospice__prof_claims{% else %}inpatient_hospice__prof_claims{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters



##office visits
  - name: office_visits__int_office_visits_injections
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits_injections{% else %}office_visits__int_office_visits_injections{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_office_visits_ptotst
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits_ptotst{% else %}office_visits__int_office_visits_ptotst{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_office_visits_radiology
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits_radiology{% else %}office_visits__int_office_visits_radiology{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_office_visits_surgery
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits_surgery{% else %}office_visits__int_office_visits_surgery{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_office_visits_em
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits_em{% else %}office_visits__int_office_visits_em{%- endif -%}
      materialized: table
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_office_visits_telehealth
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits_telehealth{% else %}office_visits__int_office_visits_telehealth{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_office_visits
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits{% else %}office_visits__int_office_visits{%- endif -%}
      materialized: table
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_detail_values
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_detail_values{% else %}office_visits__int_detail_values{%- endif -%}
      materialized: table
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_office_visits_encounter_ranking
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits_encounter_ranking{% else %}office_visits__int_office_visits_encounter_ranking{%- endif -%}
      materialized: table
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_office_visits_claim_line
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits_claim_line{% else %}office_visits__int_office_visits_claim_line{%- endif -%}
      materialized: table
      tags:
      - claims_preprocessing
      - encounters

  - name: office_visits__int_office_visits_union
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_office_visits__int_office_visits_union{% else %}office_visits__int_office_visits_union{%- endif -%}
      materialized: table
      tags:
      - claims_preprocessing
      - encounters

  - name: urgent_care__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_urgent_care__anchor_events{% else %}urgent_care__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - urgent_care

  - name: urgent_care__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_urgent_care__generate_encounter_id{% else %}urgent_care__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - urgent_care

  - name: urgent_care__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_urgent_care__match_claims_to_anchor{% else %}urgent_care__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters

  - name: outpatient_psych__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_psych__anchor_events{% else %}outpatient_psych__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_psych

  - name: outpatient_psych__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_psych__generate_encounter_id{% else %}outpatient_psych__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_psych

  - name: outpatient_psych__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_psych__match_claims_to_anchor{% else %}outpatient_psych__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_psych

  - name: outpatient_rehab__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_rehab__anchor_events{% else %}outpatient_rehab__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_rehab

  - name: outpatient_rehab__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_rehab__generate_encounter_id{% else %}outpatient_rehab__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_rehab

  - name: outpatient_rehab__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_rehab__match_claims_to_anchor{% else %}outpatient_rehab__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_rehab

  - name: outpatient_hospital_or_clinic__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_hospital_or_clinic__anchor_events{% else %}outpatient_hospital_or_clinic__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_hospital_or_clinic

  - name: outpatient_hospital_or_clinic__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_hospital_or_clinic__generate_encounter_id{% else %}outpatient_hospital_or_clinic__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_hospital_or_clinic

  - name: outpatient_hospital_or_clinic__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_hospital_or_clinic__match_claims_to_anchor{% else %}outpatient_hospital_or_clinic__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_hospital_or_clinic


  - name: asc__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_asc__anchor_events{% else %}asc__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - asc

  - name: asc__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_asc__generate_encounter_id{% else %}asc__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - asc

  - name: asc__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_asc__match_claims_to_anchor{% else %}asc__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - asc

  - name: asc__start_end_dates
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_dialysis__start_end_dates{% else %}dialysis__start_end_dates{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - asc

  - name: dialysis__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_dialysis__anchor_events{% else %}dialysis__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - dialysis

  - name: dialysis__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_dialysis__generate_encounter_id{% else %}dialysis__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - dialysis

  - name: dialysis__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_dialysis__match_claims_to_anchor{% else %}dialysis__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - dialysis

  - name: outpatient_hospice__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_hospice__anchor_events{% else %}outpatient_hospice__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_hospice

  - name: outpatient_hospice__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_hospice__generate_encounter_id{% else %}outpatient_hospice__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_hospice

  - name: outpatient_hospice__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_hospice__match_claims_to_anchor{% else %}outpatient_hospice__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_hospice

  - name: home_health__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_home_health__anchor_events{% else %}home_health__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - home_health

  - name: home_health__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_home_health__generate_encounter_id{% else %}home_health__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - home_health

  - name: home_health__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_home_health__match_claims_to_anchor{% else %}home_health__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - home_health

  - name: outpatient_injections__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_injections__anchor_events{% else %}outpatient_injections__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_injections

  - name: outpatient_injections__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_injections__generate_encounter_id{% else %}outpatient_injections__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_injections

  - name: outpatient_injections__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_injections__match_claims_to_anchor{% else %}outpatient_injections__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_injections

##
  - name: outpatient_ptotst__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_ptotst__anchor_events{% else %}outpatient_ptotst__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_ptotst

  - name: outpatient_ptotst__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_ptotst__generate_encounter_id{% else %}outpatient_ptotst__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_ptotst

  - name: outpatient_ptotst__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_ptotst__match_claims_to_anchor{% else %}outpatient_ptotst__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_ptotst
      
##
  - name: outpatient_substance_use__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_substance_use__anchor_events{% else %}outpatient_substance_use__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_substance_use

  - name: outpatient_substance_use__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_substance_use__generate_encounter_id{% else %}outpatient_substance_use__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_substance_use

  - name: outpatient_substance_use__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_substance_use__match_claims_to_anchor{% else %}outpatient_substance_use__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_substance_use
##
  - name: outpatient_radiology__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_radiology__anchor_events{% else %}outpatient_radiology__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_radiology

  - name: outpatient_radiology__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_radiology__generate_encounter_id{% else %}outpatient_radiology__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_radiology

  - name: outpatient_radiology__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_radiology__match_claims_to_anchor{% else %}outpatient_radiology__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_radiology
##
  - name: lab__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_lab__anchor_events{% else %}lab__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - lab

  - name: lab__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_lab__generate_encounter_id{% else %}lab__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - lab

  - name: lab__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_lab__match_claims_to_anchor{% else %}lab__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - lab
##
  - name: dme__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_dme__anchor_events{% else %}dme__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - dme

  - name: dme__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_dme__generate_encounter_id{% else %}dme__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - dme

  - name: dme__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_dme__match_claims_to_anchor{% else %}dme__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - dme

##
  - name: ambulance__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_ambulance__anchor_events{% else %}ambulance__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - ambulance

  - name: ambulance__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_ambulance__generate_encounter_id{% else %}ambulance__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - ambulance

  - name: ambulance__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_ambulance__match_claims_to_anchor{% else %}ambulance__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - ambulance

  - name: encounters__orphaned_claims
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_encounters__orphaned_claims{% else %}encounters__orphaned_claims{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters

##
  - name: outpatient_surgery__anchor_events
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_surgery__anchor_events{% else %}outpatient_surgery__anchor_events{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_surgery

  - name: outpatient_surgery__generate_encounter_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_surgery__generate_encounter_id{% else %}outpatient_surgery__generate_encounter_id{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_surgery

  - name: outpatient_surgery__match_claims_to_anchor
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_outpatient_surgery__match_claims_to_anchor{% else %}outpatient_surgery__match_claims_to_anchor{%- endif -%}
      materialized: view
      tags:
      - claims_preprocessing
      - encounters
      - outpatient_surgery

## Staging
  - name: encounters__stg_medical_claim
    description: Staging med claims for encounter grouper
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_encounters__stg_medical_claim{% else %}encounters__stg_medical_claim{%- endif -%}
      materialized: table 
      tags:
        - claims_preprocessing
        - encounters

  - name: encounters__stg_inpatient_institutional
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_encounters__stg_inpatient_institutional{% else %}encounters__stg_inpatient_institutional{%- endif -%}
      materialized: table
      tags:
        - claims_preprocessing
        - encounters

  - name: encounters__stg_outpatient_institutional
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_encounters__stg_outpatient_institutional{% else %}encounters__stg_outpatient_institutional{%- endif -%}
      materialized: table
      tags:
        - claims_preprocessing
        - encounters

  - name: encounters__stg_professional
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_encounters__stg_professional{% else %}encounters__stg_professional{%- endif -%}
      materialized: table
      tags:
        - claims_preprocessing
        - encounters

  - name: encounters__stg_eligibility
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_encounters__stg_eligibility{% else %}encounters__stg_eligibility{%- endif -%}
      materialized: table
      tags:
        - claims_preprocessing
        - encounters

  - name: encounters__patient_data_source_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_CLAIMS_PREPROCESSING_encounters__patient_data_source_id{% else %}encounters__patient_data_source_id{%- endif -%}
      materialized: table
      tags:
        - claims_preprocessing
        - encounters