version: 2

# Assignable models

models:
  - name: cms_provider_attribution__assignable_beneficiaries
    config:
      materialized: table    
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_cms_provider_attribution{% else %}cms_provider_attribution{%- endif -%}
      alias: assignable_beneficiaries
      tags: ["cms_provider_attribution", "final"]
    columns:
      - name: person_id
        tests:
          - not_null
      - name: performance_year
        tests:
          - not_null
      - name: aco_id
        tests:
          - not_null          
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - performance_year
            - aco_id
            - person_id 
  - name: cms_provider_attribution__assigned_beneficiaries
    config:
      materialized: table    
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_cms_provider_attribution{% else %}cms_provider_attribution{%- endif -%}
      alias: assigned_beneficiaries
      tags: ["cms_provider_attribution", "final"]
    columns:
      - name: person_id
        tests:
          - not_null
      - name: performance_year
        tests:
          - not_null
      - name: aco_id
        tests:
          - not_null          
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - performance_year
            - aco_id
            - person_id                    
  - name: cms_provider_attribution__potentially_assigned_beneficiaries
    config:
      materialized: table    
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_cms_provider_attribution{% else %}cms_provider_attribution{%- endif -%}
      alias: potentially_assigned_beneficiaries
      tags: ["cms_provider_attribution", "final"]
    columns:
      - name: person_id
        tests:
          - not_null
      - name: performance_year
        tests:
          - not_null
      - name: aco_id
        tests:
          - not_null          
    tests:
      - dbt_utils.unique_combination_of_columns:
          combination_of_columns:
            - performance_year
            - aco_id
            - person_id                                