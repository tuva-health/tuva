
{{ config(
     enabled = var('claims_enabled',var('clinical_enabled',var('tuva_marts_enabled',False)))
 | as_bool
   )
}}


select
  claim_id,
  data_source,
  person_id,
  member_id,
  diagnosis_code_type,
  diagnosis_code_1,
  diagnosis_code_2,
  diagnosis_code_3,
  diagnosis_code_4,
  diagnosis_code_5,
  diagnosis_code_6,
  diagnosis_code_7,
  diagnosis_code_8,
  diagnosis_code_9,
  diagnosis_code_10,
  diagnosis_code_11,
  diagnosis_code_12,
  diagnosis_code_13,
  diagnosis_code_14,
  diagnosis_code_15,
  diagnosis_code_16,
  diagnosis_code_17,
  diagnosis_code_18,
  diagnosis_code_19,
  diagnosis_code_20,
  diagnosis_code_21,
  diagnosis_code_22,
  diagnosis_code_23,
  diagnosis_code_24,
  diagnosis_code_25,
  diagnosis_poa_1,
  diagnosis_poa_2,
  diagnosis_poa_3,
  diagnosis_poa_4,
  diagnosis_poa_5,
  diagnosis_poa_6,
  diagnosis_poa_7,
  diagnosis_poa_8,
  diagnosis_poa_9,
  diagnosis_poa_10,
  diagnosis_poa_11,
  diagnosis_poa_12,
  diagnosis_poa_13,
  diagnosis_poa_14,
  diagnosis_poa_15,
  diagnosis_poa_16,
  diagnosis_poa_17,
  diagnosis_poa_18,
  diagnosis_poa_19,
  diagnosis_poa_20,
  diagnosis_poa_21,
  diagnosis_poa_22,
  diagnosis_poa_23,
  diagnosis_poa_24,
  diagnosis_poa_25

from(
  select
    claim_id,
    data_source,
    row_number() over (
      partition by claim_id, data_source order by claim_line_number
    ) as row_num,
    person_id,
    member_id,
    diagnosis_code_type,
    diagnosis_code_1,
    diagnosis_code_2,
    diagnosis_code_3,
    diagnosis_code_4,
    diagnosis_code_5,
    diagnosis_code_6,
    diagnosis_code_7,
    diagnosis_code_8,
    diagnosis_code_9,
    diagnosis_code_10,
    diagnosis_code_11,
    diagnosis_code_12,
    diagnosis_code_13,
    diagnosis_code_14,
    diagnosis_code_15,
    diagnosis_code_16,
    diagnosis_code_17,
    diagnosis_code_18,
    diagnosis_code_19,
    diagnosis_code_20,
    diagnosis_code_21,
    diagnosis_code_22,
    diagnosis_code_23,
    diagnosis_code_24,
    diagnosis_code_25,
    diagnosis_poa_1,
    diagnosis_poa_2,
    diagnosis_poa_3,
    diagnosis_poa_4,
    diagnosis_poa_5,
    diagnosis_poa_6,
    diagnosis_poa_7,
    diagnosis_poa_8,
    diagnosis_poa_9,
    diagnosis_poa_10,
    diagnosis_poa_11,
    diagnosis_poa_12,
    diagnosis_poa_13,
    diagnosis_poa_14,
    diagnosis_poa_15,
    diagnosis_poa_16,
    diagnosis_poa_17,
    diagnosis_poa_18,
    diagnosis_poa_19,
    diagnosis_poa_20,
    diagnosis_poa_21,
    diagnosis_poa_22,
    diagnosis_poa_23,
    diagnosis_poa_24,
    diagnosis_poa_25
  from {{ ref('medical_claim') }}
)
where row_num = 1
