version: 2
models:

#### Data Quality
## Final
  - name: data_quality__chronic_conditions_prevalence
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_chronic_conditions_prevalence{% else %}chronic_conditions_prevalence{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__chronic_conditions_none
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_chronic_conditions_none{% else %}chronic_conditions_none{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__encounters_cost_and_utilization_trend
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_encounters_cost_and_utilization_trend{% else %}encounters_cost_and_utilization_trend{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__service_category_pmpm_trend
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_service_category_pmpm_trend{% else %}service_category_pmpm_trend{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__dx_and_px
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_dx_and_px{% else %}dx_and_px{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: data_quality_check
        description: The name of the data quality check
      - name: result_count
        description: The number of rows in the input layer that match the data quality
          check criteria
      - name: tuva_last_ran
        description: '{{ doc("tuva_last_run") }}'

  - name: data_quality__eligibility_date_checks
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_eligibility_date_checks{% else %}eligibility_date_checks{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: data_quality_check
        description: The name of the data quality check
      - name: result_count
        description: The number of eligibility spans in the input layer that match
          the data quality check criteria
      - name: tuva_last_ran
        description: '{{ doc("tuva_last_run") }}'


  - name: data_quality__eligibility_demographics
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_eligibility_demographics{% else %}eligibility_demographics{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: data_quality_check
        description: The name of the data quality check
      - name: result_count
        description: |
          The number of eligibility spans in the input layer that match the data quality check criteria (multiple birth dates
          count unique members)
      - name: tuva_last_ran
        description: '{{ doc("tuva_last_run") }}'


  - name: data_quality__eligibility_missing_person_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_eligibility_missing_person_id{% else %}eligibility_missing_person_id{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: data_quality_check
        description: The name of the data quality check
      - name: result_count
        description: The number of eligibility spans in the input layer that match
          the data quality check criteria
      - name: tuva_last_ran
        description: '{{ doc("tuva_last_run") }}'


  - name: data_quality__eligibility_missing_payer
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_eligibility_missing_payer{% else %}eligibility_missing_payer{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: data_quality_check
        description: The name of the data quality check
      - name: result_count
        description: The number of eligibility spans in the input layer that match
          the data quality check criteria
      - name: tuva_last_ran
        description: '{{ doc("tuva_last_run") }}'

  - name: data_quality__encounters_cost_and_utilization
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_encounters_cost_and_utilization{% else %}encounters_cost_and_utilization{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__encounters_missing_groups_union
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_encounters_missing_groups_union{% else %}encounters_missing_groups_union{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__encounters_missing_groups
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_encounters_missing_groups{% else %}encounters_missing_groups{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table


  - name: data_quality__eligibility_trend
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_eligibility_trend{% else %}eligibility_trend{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: year_month
        description: The year and month
      - name: member_months
        description: The count of distinct members with eligibility in the corresponding
          year and month
      - name: tuva_last_ran
        description: '{{ doc("tuva_last_run") }}'

  - name: data_quality__claim_date_trends
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_claim_date_trends{% else %}claim_date_trends{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: year_month
        description: The name of the data quality check
      - name: claim_start_date
        description: The count of distinct claims with a claim start date in the corresponding
          year and month.
      - name: claim_end_date
        description: The count of distinct claims with a claim end date in the corresponding
          year and month.
      - name: admission_date
        description: The count of distinct claims with a admission date in the corresponding
          year and month.
      - name: discharge_date
        description: The count of distinct claims with a discharge date in the corresponding
          year and month.
      - name: medical_paid_date
        description: The count of distinct claims with a medical paid date in the
          corresponding year and month.
      - name: dispensing_date
        description: The count of distinct claims with a dispensing date in the corresponding
          year and month.
      - name: pharmacy_paid_date
        description: The count of distinct claims with a pharmacy paid date in the
          corresponding year and month.
      - name: tuva_last_ran
        description: '{{ doc("tuva_last_run") }}'

  - name: data_quality__data_quality_test_summary
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_test_summary{% else %}data_quality_test_summary{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: data_quality_check
        description: The name of the data quality check
        tests:
          - unique
          - not_null
      - name: result_count
        description: the count of records that match the result of the data quality
          check
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: data_quality__analytics_reference_summary
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_analytics_reference_summary{% else %}analytics_reference_summary{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__analytics_checks_summary
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_analytics_checks_summary{% else %}analytics_checks_summary{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

    columns:
      - name: data_quality_check
        description: The name of the data quality check
        tests:
          - unique
          - not_null
      - name: result_count
        description: the count of records that match the result of the data quality
          check
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

  - name: data_quality__pharmacy_claim_person_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_pharmacy_claim_person_id{% else %}pharmacy_claim_person_id{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__pharmacy_claim_date_checks
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_pharmacy_claim_date_checks{% else %}pharmacy_claim_date_checks{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__pharmacy_claim_ndc
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_pharmacy_claim_ndc{% else %}pharmacy_claim_ndc{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__pharmacy_claim_prescription_details
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_pharmacy_claim_prescription_details{% else %}pharmacy_claim_prescription_details{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__pharmacy_claim_npi
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_pharmacy_claim_npi{% else %}pharmacy_claim_npi{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__pharmacy_claim_volume_and_dollars
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_pharmacy_claim_volume_and_dollars{% else %}pharmacy_claim_volume_and_dollars{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: year_month
        description: the year and month in format yyyymm
      - name: claim_volume
        description: the unique count of claims
      - name: paid_amount
        description: '{{ doc("paid_amount") }}'
      - name: tuva_last_ran
        description: '{{ doc("tuva_last_run") }}'


  - name: data_quality__primary_key_check
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_primary_key_check{% else %}primary_key_check{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__medical_claim_person_id
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_medical_claim_person_id{% else %}medical_claim_person_id{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__medical_claim_date_checks
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_medical_claim_date_checks{% else %}medical_claim_date_checks{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__medical_claim_inst_header_fields
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_medical_claim_inst_header_fields{% else %}medical_claim_inst_header_fields{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__medical_claim_claim_line_fields
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_medical_claim_claim_line_fields{% else %}medical_claim_claim_line_fields{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__medical_claim_provider_npi
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_medical_claim_provider_npi{% else %}medical_claim_provider_npi{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__medical_claim_volume_and_dollars
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_medical_claim_volume_and_dollars{% else %}medical_claim_volume_and_dollars{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: year_month
        description: the year and month in format yyyymm
      - name: claim_volume
        description: the unique count of claims
      - name: paid_amount
        description: '{{ doc("paid_amount") }}'
      - name: tuva_last_ran
        description: '{{ doc("tuva_last_run") }}'


  - name: data_quality__data_loss
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_loss{% else %}data_loss{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: table_name
        description: the name of the table's records being counted
      - name: metric
        description: the name of the metric being analyzed
      - name: input_layer_value
        description: the count of the metric found in the input layer schema of the
          table
      - name: core_value
        description: the count of the metric found in the core layer schema of the
          table
      - name: tuva_last_run
        description: '{{ doc("tuva_last_run") }}'

      


  - name: data_quality__core_populated
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_core_populated{% else %}core_populated{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: table_name
        description: the name of the table's records being counted
      - name: record_count
        description: the total number of records belonging to the specific data quality
          check


  - name: data_quality__analytics_populated
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_analytics_populated{% else %}analytics_populated{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
    columns:
      - name: table_name
        description: the name of the table's records being counted
      - name: record_count
        description: the total number of records belonging to the specific data quality
          check

  - name: data_quality__readmissions
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_readmissions{% else %}data_quality_readmissions{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table


  - name: data_quality__readmissions_reference
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_readmissions_reference{% else %}data_quality_readmissions_reference{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__service_categories_pmpm
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_service_categories_pmpm{% else %}service_categories_pmpm{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__cms_hcc
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_cms_hcc{% else %}data_quality_cms_hcc{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__cms_hcc_reference
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_cms_hcc_reference{% else %}data_quality_cms_hcc_reference{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__quality_measures_reference
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_quality_measures_reference{% else %}data_quality_quality_measures_reference{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__quality_measures
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_quality_measures{% else %}data_quality_quality_measures{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__acute_inpatient_reference
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_acute_inpatient_reference{% else %}data_quality_acute_inpatient_reference{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__acute_inpatient
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_acute_inpatient{% else %}data_quality_acute_inpatient{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__acute_inpatient_prevalence
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_acute_inpatient_prevalence{% else %}data_quality_acute_inpatient_prevalence{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__ed_classification
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_ed_classification{% else %}data_quality_ed_classification{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__ed_classification_reference
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_ed_classification_reference{% else %}data_quality_ed_classification_reference{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__financial_pmpm
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_financial_pmpm{% else %}data_quality_financial_pmpm{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table

  - name: data_quality__claim_percent
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality_claim_percent{% else %}data_quality_claim_percent{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table



#### stage
  - name: data_quality__eligibility_dq_stage
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality__eligibility_dq_stage{% else %}data_quality__eligibility_dq_stage{%- endif -%}
      tags:
        - data_quality_audit
      materialized: view

  - name: data_quality__inpatient_dq_stage
    config:
      schema: |
        {%- if var('tuva_schema_override',None) != None -%}{{var('tuva_schema_override')}}{% else %}{%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
        {% else %}data_quality{%- endif -%}{%- endif -%}
      alias: |
        {%- if var('tuva_schema_override',None) != None -%}TUVA_DATA_QUALITY_data_quality__inpatient_dq_stage{% else %}data_quality__inpatient_dq_stage{%- endif -%}
      tags:
        - data_quality_audit
      materialized: table
