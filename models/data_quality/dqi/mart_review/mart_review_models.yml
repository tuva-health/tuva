version: 2
models:
#### Mart review
## Final

- name: mart_review__claims_with_enrollment
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__claims_with_enrollment
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__data_source
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__ed_classification
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__ed_classification
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__enrollment_change
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__enrollment_change
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__inpatient
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__inpatient
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__member_months
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__member_months
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__members_with_claims
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__members_with_claims
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__number_of_conditions
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__number_of_conditions
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__patient
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__patient
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table


- name: mart_review__pharmacy
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__pharmacy
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__pmpm
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__pmpm
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__readmissions
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__readmissions
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__readmission_rate_monthly
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__readmission_rate_monthly
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__tuva_chronic_conditions
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__tuva_chronic_conditions
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__calendar_month
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__calendar_month
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table


## Deprecated/Removed: patient risk models migrated to cms_hcc package for direct use in export

# quality_measures models are not present in this package currently

- name: mart_review__generics
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__generics
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__service_categories_long
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__service_categories_long
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table  

- name: mart_review__age_distribution
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__age_distribution
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__gender_distribution
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__gender_distribution
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__condition_counts
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__condition_counts
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__inpatient_los_distribution
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__inpatient_los_distribution
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__drg_counts
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__drg_counts
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__ed_avoidable_counts
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__ed_avoidable_counts
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__pharmacy_brand_generic
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__pharmacy_brand_generic
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__encounters_group_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__encounters_group_type
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

## Deprecated: encounters_by_group / encounters_by_type now derived in export from encounters_group_type

- name: mart_review__risk_score_monthly
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__risk_score_monthly
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__demographic_factor_counts
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__demographic_factor_counts
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__hcc_counts
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__hcc_counts
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__pharmacy_summary
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__pharmacy_summary
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__pharmacy_summary_top_ndc
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__pharmacy_summary_top_ndc
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__dashboard_export
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__dashboard_export
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table



## Stage
- name: mart_review__stg_medical_claim
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__stg_medical_claim
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__stg_pharmacy_claim
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__stg_pharmacy_claim
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table

- name: mart_review__stg_member_month
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: mart_review__stg_member_month
    tags:
      - data_quality_mart_review
      - dqi
    materialized: table
